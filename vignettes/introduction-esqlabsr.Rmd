---
title: "Introduction to esqlabsR"
output: 
  rmarkdown::html_vignette:
    toc: true
#output: pdf_document
vignette: >
  %\VignetteIndexEntry{Introduction to esqlabsR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dpi = 300
)
```

The **`{esqlabsR}`** R-package is designed to facilitate and standardize **modeling and simulation** (M&S) of PBPK and QSP models implemented in [Open Systems Pharmacology Software](https://www.open-systems-pharmacology.org/) (OSPS) and executed from R. The package provides functions to read and run scenarios, workflows and simulations and create plots and visualization based on no-code input from Excel files. The package is based on R functions in the [`ospsuite` package](https://github.com/Open-Systems-Pharmacology/OSPSuite-R).


## Motivation

This package builds up on the functionality of the `{ospsuite}` package. It is strongly recommended to get familiar with the [R Introduction](https://docs.open-systems-pharmacology.org/working-with-r/introduction-ospsuite-r) section of the OSPS manual.

In order to load a simulation in R, it must be present in the **\*.pkml** file format. Every simulation in PK-Sim or MoBi can be exported to the *.pkml file. The examples shown in this documentation are based on the Aciclovir example model, until stated otherwise. The model can be found in the [GitHub repository](https://github.com/Open-Systems-Pharmacology/Example_Aciclovir) as PK-Sim project. The pkml file can be downloaded from [ospsuite-r](https://github.com/Open-Systems-Pharmacology/OSPSuite-R/blob/develop/inst/extdata/Aciclovir.pkml) repository.

The articles below covers several aspects of the software usage:

* [Data handling](data-handling.html)
* [Running simulations](example-workflow.html)
* [Visualization and reporting](example-visualization.html)
* [Sensitivity analysis](example-sensitivity.html)

## Object-oriented approach

The `{esqlabsR}` package utilizes the concept of object-oriented (OO) programming based on the [R6 system](https://adv-r.hadley.nz/r6.html). While the philosophy of the package is to offer a functional programming workflow more common for the R users, it is important to understand some basic concepts of the OO programming. Many of the functions implemented in `{esqlabsR}` return an *instance* (or an *object*) of a *class*. These objects can be used as inputs for other methods. Additionally, each object offers a set of properties (which can be other objects) and methods, which are accessible by the `$` sign:

```r
# create an instance of an object
object1 <- ClassName$new()

# extract a property associated with this object
aProperty <- object1$property1

# apply a method associated with this object
resultOfAFunction <- object1$multiply(1,2)
```

Important information about the object can be printed out by calling `print(object)`.

## Configuring a project with no-code Excel files

To facilitate modeling activities in a team with diverse backgrounds, `esqlabsR` employs Excel configuration files that define every aspect of a modeling project. The cornerstone of this configuration is a `ProjectConfiguration.xlsx` Excel file that should be located in the `/Code/` folder of the work package. This Excel file is expected to contain fields that populate an instance of a [`ProjectConfiguration` class](../reference/ProjectConfiguration.html). Paths and filenames in the project configuration Excel file are used later to [read observed data](/data-handling.html), define the [simulation scenarios](/example-workflow.html) and store the analysis results.

The project configuration Excel file references eight more Excel files that contain model parameters, scenario definitions and compound properties. Example of configuration files are included in the `/tests/data/TestProject` folder of the repository.

